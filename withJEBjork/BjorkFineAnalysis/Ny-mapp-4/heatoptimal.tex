\documentclass{amsart}
\usepackage[applemac]{inputenc}
\addtolength{\hoffset}{-12mm}
\addtolength{\voffset}{-10mm}
\addtolength{\textheight}{20mm}

\def\uuu{_}


\def\vvv{-}

 
\begin{document}


\centerline{\bf{The heat equation and  Brownian motion}}
\medskip


\[ \emph{Lecture for  conference at Abbis Abeba July 2009 }
\]

\[
\text{Jan-Erik Bjšrk Stockholm University Sweden}
\]
\bigskip

\noindent
{\bf{Introduction.}}
This  brief note
is a supplement to the the more detailed material in
[XX] which appears as a chapter in  the extensive notes on analytic function theory
from by  course held at the department
of mathematics in
Abbis Abeba in Februay-March 2009.
The heat equation has a long history whose
physical relevance has inspired mathematicians to develop
methods  to obtain  solutions.
A major  step was introduced  by Fourier around 1810 which gives a recipe
to solve  the heat equation
with prescribed boundary values.
We  restrict the discussion  to  the 2\vvv dimensional case 
where the basic PDE\vvv equation is
\[
\frac{\partial u}{\partial t}(t,z)= \Delta(u)(z,t)\tag{*}
\]
Here $t$ is a time variable and $z=x+iy$ moves in a domain
$\Omega$  of the complex plane.
The PDE\vvv equation corresponds to 
a  Brownian motion  in
$\Omega$. Suppose that
the density of particles observed at time $r=0$
is observed and expressed  by a density function $g\uuu 0(z)$, i.e. $g$ is  
real\vvv valued and non\vvv negative and its area integral over
$\Omega$ is one.
When $t>0$ the classical laws in physics mean that the observed density at some time
$t>0$ is expressed by 
a density function $x\mapsto u(z,t)$ where  $u$ solves (*) and
and  satisfies the  following
boundary condition  for every $t>0$:
\[ 
\frac{\partial u}{\partial n}(z,t)=0\quad
\colon \quad z\in\partial \Omega\tag{1}
\]


\noindent
In addition one has an initial density distribution at time zero, i.e.
$u(0,z)= g\uuu 0(z)$.
\medskip

\noindent
  {\bf{Schršdinger's boundary value problem.}}
Quantum mechanics
led to   problems which 
from a mathematical point of view
gives rise  to  non\vvv linear  equations
of considerable interest for mathematicians.
A precise question was raised by Schršdinger in his famous article
\emph{ThŽorie relativiste de l'Žlectron et l'interpretation de la
mŽcanique quantique} from 1932.
The solution $u(x,t)$  above is not valid
in the non\vvv classical case while another density 
$z\mapsto f\uuu 1(z)\neq u(t\uuu 1,z)$
is observed at some time
$t\uuu 1>0$.
Thus, something highly improbable
but nevertheless possible has occurred
during the time interval $[0,t\uuu 1]$.
Schršdinger asked for the most likely density a time
$t\uuu 1$.
He concluded that that the requested 
time\vvv dependent
density $w(t,z)$ which substitutes $u(t,z)$ above, is found
in a non\vvv linear class of functions
$\mathcal W$ formed by products 
\[ 
u\uuu 0(t,z)\cdot u\uuu 1(z,t)
\]
where $u\uuu 0(z,t)$ is a solution to the 
heat equation (*) while $u\uuu 1$ solves the adjoint equation
\[ 
\frac{\partial u\uuu 1}{\partial n}(z,t)=\vvv \Delta(u\uuu 1)(t,z)
\quad\text{for time values}\quad t<t\uuu 1
\]
and satisfies the  boundary condition (1).
Now one seeks a function $w(t,z)$ in the family $\mathcal W$
which satisfies  two  boundary value conditions
\[ 
w(0,z)= f\uuu 0(z)\quad\colon\quad w(t\uuu 1,z)= f\uuu 1(z)\tag{**}
\] 
where $f\uuu 0,f\uuu 1$ is a pair of \emph{prescribed} density functions.
The mathematical problem is now to determine
a pair of functions $g_0(x)= u_0(x,0)$ and $g_1(x,t_1)= u_1(x,t_1)$
such that
(**) holds
The solution to this  problem  can be   transformed
into a system of non\vvv linear integral equations.
Namely,  for the given domain
$\Omega$ there exists the Poisson\vvv Greens function $K(t,z,\zeta)$
and we have

\[
u\uuu 0(t,z)= \iint\uuu\Omega\,
K(t,z,\zeta)\cdot g\uuu 0(\zeta)\, d\xi d\eta
\]
\[
u\uuu 1(t,z)= 
\iint\uuu\Omega\,
K(t\uuu 1\vvv t,z,\zeta)\cdot g\uuu 1(\zeta)\, d\xi d\eta
\]
Next, the boundary conditions for $w$ yield

\[
f\uuu 0(z)=
g\uuu 0(z)\cdot 
\iint\uuu\Omega\,
K(\vvv t\uuu 1,z,\zeta)\cdot g\uuu 1(\zeta)\cdot d\xi d\eta
\]
\[
f\uuu 1(z)=
g\uuu 1(z)\cdot 
\iint\uuu\Omega\,
K(\vvv t\uuu 1,z,\zeta)\cdot g\uuu 1(\zeta)\cdot d\xi d\eta
\]
\medskip

\noindent
{\bf{Remark.}}
Notice that the last two equations means that
the requested pair of $g$-functions for a given pair of $f$-functions means that
one has a non-linear system of integral equations.
The
solvability of this system  was left open by Schršdinger but
was  put forward to the mathematical community at the IMU\vvv
congress in ZŸrich  1932 in the plenary talk by
Serge Bernstein. In 1940 Fortet  published the article
\emph{RŽsolution d'un systeme d'Žquations de Schršdinger}
which gave a methods for  approximating
solutions under some specific conditions  on the boundary data.
A general method to find solutions to a non-linear system as above
was  introduced by Beurling in the article [Beurling].
It is exposed in ¤ XX from Special sections and demonstrates the 
existence of solutions to the system above for smooth domains in ${\bf{R}}^2$.
Beulring's theoretical solution is  implicit since it is
established
via a certain non\vvv linear variational problem for product measures defined 
via  Poisson\vvv Green's function.

\medskip

\noindent
{\bf{The classical heat\vvv equation.}}
From now on we restrict the study to the ordinary
heat equation.
We shall not attempt  to expose all  details about this equation
since
it would require an extensive chapter in PDE\vvv theory. Let us only remark
that (*) is an example of a parabolic 
equation for which  uniqueness and existence of solutions with
prescribed initial conditions were studied at an early stage
by Gevrey, Hadamard and Holmgren. More recent progress was 
achieved by Petrowsky, Khintchine and Kolmogorov which 
established the  relation between
solutions to heat equations and stochastic processes.
\medskip

\noindent
An notable  point
is that the heat equation can be rewritten as an
integral equation. This was  already  used
in pioneering work by Ivar Fredholm and 
leads to    existence theorems and insight about
associated eigenvalues and 
eigenfunctions under quite general 
boundary value conditions. We shall restrict the discussion to
the  heat
equation in the complex domain where results about Green\vvv kernels from Chapter V 
can be applied. 
Let $z=x+iy$ be a complex variable and 
$\Omega$ is a domain 
whose boundary consists of $p$ many closed and disjoint differentiable Jordan curves.
Here $p$ is some positive integer and  the case $p=1$ is not excluded.
In Chapter V we constructed the Green's function $G(z,\zeta)$
defined in the closed product $\bar \Omega\times\bar \Omega$.
Denote by $C\uuu *(\Omega)$ the Banach space of continuous functions
in $\bar\Omega$ which are zero on the boundary.
Then there exists the linear operator from
this Banach space into itself defined by
\[
Tu(z)=\iint\uuu\Omega\, G(z,\zeta) u(\zeta) \cdot d\xi d\eta
\]
Recall from ¤¤ in Chapter V
that if $\phi$ is a $C^2$\vvv function with compact
support in
$\Omega$ then
\[
\iint\uuu\Omega\, \Delta(\phi)(z) \cdot u(\zeta) dx dy=
\iint\uuu\Omega\, \phi(z) \cdot Tu(\zeta) dx dy
\]
This equation means that $Tu$ regarded as a distribution has a Laplacian expressed by
the continuous density $u$, i.e. one has the equality
\[
\Delta(Tu)(z)=u(z)\quad\colon\quad z\in\Omega
\]
Let  $u\in C^0\uuu *(\Omega)$ be an eigenfunction
where
\[
u(z)=\mu\cdot Tu(z)
\] 
holds for some non\vvv zero constant $\mu$ which by the above gives
\[
\Delta(u)=\frac{1}{\mu}\cdot u
\] 
In particular $u$ is of class $C^2$ in $\Omega$ and
Green's formula gives:

\[
\mu\cdot \iint\uuu\Omega\, \Delta(u)(z) \cdot u(z) dx dy=
\iint\uuu\Omega\, \nabla(u)^2(z) \cdot dx dy=0
\]
where
$\nabla(u)^2= u\uuu x^2+u\uuu y^2$.
Hence the eigenvalue $\mu$ is real and strictly negative.
\medskip

\noindent
{\bf{1. The spectrum of $T$ and the function $\mathcal D(\lambda)$}}.
Set $G^{(0)}= G$ and define inductively

\[
 G^{(m)}(z,\zeta)=
\mu\cdot \iint\uuu\Omega\, G(z,\zeta) \cdot 
 G^{(m\vvv 1)}(z,\zeta)\cdot d\xi d\eta
\]
Let $\lambda$ be a new complex parameter and put
\[
\mathcal D(\lambda)= \sum\uuu{m=0}^\infty\,
\lambda^m\cdot G^{(m)}(z,\zeta)
\]


\noindent
We  regard $\mathcal D(\lambda)$ as a function with values
in the  Hilbert space of square integrable functions on 
the product $\Omega\times\Omega$, i.e. we use that
\[
\iint\uuu {\Omega\times \Omega}\, 
|G(z,\zeta)|^2\cdot d\xi d\eta dxdy<\infty
 \]
and similar finite double integrals occur for the functions
$\{ G^{(m)}\}$. With these nottions
one has the general result below which was established
by Carleman in already in 1918 based upon previous inequalities due to Fredholm, Hadamard and Hilbert.

\medskip

\noindent
{\bf{2. Theorem.}}
\emph{The function $\mathcal D(\lambda)$ extends to a meromorphic function in
the whole complex $\lambda$\vvv plane whose poles are confined
to a sequence of strictly negative real numbers.}
\bigskip

\noindent
{\bf{3. The heat equation.}}
Let $\{\lambda\uuu k\}$ be the poles of $\mathcal D$. 
If the pole has multiplicity $e\uuu k\geq 2$  the corresponding eigenspace
is $e\uuu k$\vvv dimensional.
Repeating eigenvalues with eventual multiplicities we obtain
a sequence of eigenfunctions $\{u\uuu k\}$ with eigenvalues
$\{\lambda\uuu k\}$ and for each $k$ the eigenfunction $u\uuu k$
is normalised so that
\[
\iint u\uuu k^2(x,y)\cdot dxdy=1
\]
and  chosen so that
they form an
orthonormal set in the Hilbert space $L^2(\Omega$. Notice  that
every $u$\vvv function is real\vvv valued.
Next, let $t$ be a new real parameter which
serves as a time variable.
If $\{c\uuu k\}$ is a sequence of complex numbers
we  set
\[ 
p(t,z)=
\sum\uuu{k=1}^\infty\, c\uuu k\cdot e^{\vvv\lambda\uuu k t}\cdot
u\uuu k(z)
\]
The series converges nicely when $t>0$
if $\{c\uuu k\}$ do not increase too
rapidly and
the $p$\vvv function satisfies the PDE\vvv equation
\[
\frac{\partial p}{\partial t}= \Delta(p)
\] 
when $t>0$ and $z\in\Omega$.
Next, the sequence  $\{c\uuu k\}$
determines an initial condition which usually is interpretated via
a limit
\[ 
\lim\uuu{t\to 0}\, p(t,z)= p\uuu *(z)
\] 
where $p\uuu *(z)$ is a distribution.
If $p\uuu *$ belongs to $L^2$ we have for example
\[
c\uuu k=\iint p\uuu *(z)u\uuu k(z)\cdot dxdy
\]
\bigskip


\noindent {\bf{4. The Brownian  motion.}}
As explained in ¤¤  solutions to the heat equation
correspond to probability densities for a particle whose 
time\vvv dependent change of position is 
governed by a Brownian motion.
For example, if $z\in\Omega$ is given and the particle starts at $z$ at time zero then
we consider the probability distribution:
\[ 
t\mapsto \text{Prob}(z,t)
\] 
which gives the probability that the particle stays in $\Omega$ 
up to time $t$.
Since $\Omega$ is bounded the particle eventually hits the boundary where it
is absorbed.
It means that
\[ 
\lim\uuu {t\to\infty}\, \text{Prob}(z,t)=0
\]
On the other hand the particle stays in $\Omega$ with high probability under
short time intervals, i.e.
\[
\lim\uuu {t\to 0}\, \text{Prob}(z,t)=1\tag{1}
\] 
Above (i\vvv ii) hold for every $z\in\Omega$.
The function
\[ 
p(t,z)=\text{Prob}(z,t)
\]
satisfies the heat equation and by (1)
given by the series
\[
p(t,z)= \sum\, c\uuu k\cdot 
e^{\vvv\lambda\uuu k t}\cdot
u\uuu k(z)
\quad\text{where}\quad
c\uuu k= \iint\uuu\Omega\, u\uuu k(z)\cdot dxdy\tag{*}
\]
\medskip

\noindent
{\bf{4.1 The $E$\vvv function.}}
When the particle starts at a point $z$  
the expected time before it hits the boundary is given by the equation:
\[ 
E(z)=
\vvv \int\uuu 0^\infty\, t\cdot
\frac{\partial p}{\partial t}(t,z)\cdot dt
\]
Since $p$ satsifies the heat equation and the differential operators
$\partial\uuu t$ and the Laplacian of the independent $z$\vvv variable commute
with, it follows that
\[
\Delta(E)(z)=\vvv \int\uuu 0^\infty\, t\cdot
\frac{\partial^2 p}{\partial t^2}(t,z)\cdot dt
\]
After a partial integration we find that
\[
\Delta(E)(z)=\vvv 1
\]
Hence the function
\[ 
E(z)+\frac{|z|^2}{2}
\]
is harmonic in $\Omega$ and since $E=0$ on the boundary
we conclude that

\[
 E(z)=\int\uuu{\partial\Omega}\, P\uuu z(\zeta)\cdot \frac{|\zeta|^2}{2}
 \cdot d\xi d\eta\vvv \frac{|z|^2}{2}
\]

\medskip

\noindent
where $P\uuu z(\zeta)$ is the Poisson kernel which exhibits solutions to
the Dirichlet problem.
\medskip

\noindent
{\bf{4.2 Example.}}
Let $\Omega=\{|z|<R\}$ be a disc. Then
\[
E(z)= \frac{1}{2}(R^2\vvv |z|^2)
\]
Next, let $\Omega=\{ 1<|z|<R\}$ be an annulus.
Then the reader may verify that

\[ 
E(z)=\frac{R^2\vvv 1}{2}\cdot \frac{\log|z|}{\log R}
+\frac{1\vvv |z|^2}{2}
\]
Notice that $E$ takes its maxium  over the circle of radius $r^ *$
where
\[
r^*=\sqrt{\frac{R^2\vvv 1}{2\ddot \log R}}
\]
The reader is invited to interpretate the  formulas above
by  probabilistic considerations.
\bigskip


\noindent
{\bf{4.3 Points of arrival.}}
Let $\omega$ be 
some finite union of open subintervals of  $\partial\Omega$.
Starting the Brownian motion at a point $z\in\Omega$
we can consider the paths which at the first arrival to the boundary
hits points in $\omega$.
Again we get a $p$\vvv function which satisfies the heat equation
but here the initial condition is different and depends
upon $\omega$.
More precisely, the probability that a Brownian path
escapes for the first time at a point in $\omega$ is given by the value of the 
harmonic measure
function $\mathfrak{m}(\omega,z)$
Now we define the function
\[
p\uuu \omega(t,z)=
\sum\, c\uuu k(\omega)\cdot e^{\vvv\lambda\uuu k\cdot t}\cdot u\uuu k(z)
\]
where $\{c\uuu k(\omega)\}$ are determined by
\[
c\uuu k(\omega)=\iint\uuu\Omega\,
\mathfrak{m}(\omega,z)\cdot u\uuu k(z)\cdot dxdy
\]
\medskip

\noindent
{\bf{4.4 A joint probability distribution.}}
Let $\omega$ be some open set of $\partial\Omega$ as above
and $t>0$ some fixed time\vvv value. With a small $\delta t$
we seek the probability that the particle
which starts at some  $z$,
escapes at some point in
$\omega$ 
for the first time during the interval $[t,t+\delta t]$.
From the above this probability up to small ordo of $\delta t$
is given by:
\[
\bigl[\, \sum\, c\uuu k(\omega)\cdot \lambda\uuu k\cdot
e^{\vvv\lambda\uuu k\cdot t}\cdot u\uuu k(z)\,\bigr]\cdot \delta t
\]
\medskip

\noindent
{\bf{4.5 Example.}}
Suppose that the "open window" which  the particle 
wants  to hit on the boundary changes with time.
The probability that it will escape through the changing  window becomes
\[
\sum\, 
[\int\uuu 0^\infty\, c\uuu k(\omega\uuu t) e^{\vvv \lambda\uuu k t}\cdot dt\,]
\cdot
\lambda\uuu k\cdot u\uuu k(z)\tag{*}
\]
\medskip


\noindent
{\bf{4.6 A special case.}}
Suppose that $\Omega$ is the unit disc
and $z=0$ the starting point.
Let $0<a<\pi$ and suppose that the interval $\omega\uuu t$
is $(\vvv a\cdot |\sin \gamma t|,a\cdot |\sin\gamma t|)$ where 
$\gamma>0$ is a constant.
So the window is closed when $t=0$ and has maximal width at time values when
$|\sin\,\gamma t|=1$.
Here we have:
\[
c\uuu k(\omega\uuu t)=\frac{a\cdot |\sin(\gamma t|}{\pi}
\]
\medskip

\noindent
{\bf{4.7 Remark.}}
The reader may consult text\vvv books for the classic formulas which
determine the sequence of eigenvalues $\{\lambda\uuu k\}$ and
the sequence $\{u\uuu k(0)\}$ in a disc.
So admitting this one has 
a  formula for the probability to escape the changing window. However,
a computer should be used
to obtain a numerical value.
Let us also remark that one can also employ Monte Carlo simulations
to determine (*) above. More precisely
one instructs the computer to change
the size of the open window and efficient use of MathLab provide  accurate
approximations and  there is no difficulty to extend the situation to the case 
when one starts from an
arbitrary point in $D$. One can go further  and  replace the special
"opening function" $|a|\cdot |\sin \gamma t|$ by other time dependent functions
and 
numerical solutions are obtained
via Monte Carlo simulations, i.e.  we get approximative
values for
the probability to escape a moving window on the boundary of
an arbitrary domain in
$\mathcal D(C^1)$.
\medskip

\noindent
Passing to higher dimensions where the case $n=3$ is of special interest
one can still employ Mone Carlo simulations and
establish numerical values for many different expected values
as well as higher moments and other 
joint distributions.
\bigskip


\noindent
{\bf{4.8 More involved problems.}}
Above we were contwnt to express various distribution functions for
the time of first arrival to the boundary.
One can also ask for positons of a particle during the time interval before it hits
the boundary. Consider the case when
$\Omega=D$ is the junit disc and
the Brownian motion starts at the origin. On the circle we consider  some interval 
$\omega=\{  |e^{i\theta}-1|<a\}$ for some
$0<a<\pi/2$.
Now we pursue the family of Browwinan paths which hiut
on their first arrival to $T$ hit points in $\omega$.
it is intuitively clear that
these paths are not symmetrically distributed, i.e a majority has a drieft towards
points on the interval $\omega$.
The distribution function $p(t)$ for the time of arrival was determined before.
But we can introduce many other probability densities. 
For example let  $D_r$ be the disc of radius $r<1$ centered at the origin.
Given the interval $\omega$ above we conisder the sample space
$\mathcal B_\omega$ of all Brownian paths
which start at the origin and hit $\omega$ on their first arrival to
the unit circle.
Every $\gamma\in\mathcal B_\omega$
visits the open disc $D_r$ during some union of time
intervals $\{t_k,T_{k+1}\}$ and
let $\tau(\gamma)0 \sum\,(t_{k+1}-t_k)$ be the total time
while $\gamma$ is in $D_r$ until it eventually escapes and hits
$\omega$. So here
\[ 
\gamma\mapsto \tau(\gamma)
\] 
is a random variable and one may ask for its expected value and also for higher
moments and even its probability distribution will  depend upon
the pair $a$ and $r$.
It appears that problems of thins kind have not been fylly studied in
analysis, i.e. one should first discover "closed analytic formulas"
and after Monte Carlo simulations can be used to
get numerical solutions.
Notice that one can continue and pose many
problems of this ind where various obstacles and changes
of barriers occur.
Thus, in principle there is an unlimited number of questions. But
of course one shuold try to find questions with relevance to
some natural  model in science.
However, from a mathematical point of viev
the search for analytic solutions to problems described above
appears to be promising. of course, exactly as in the case of the heat equation 
such solutions are stiull a implicit since they for example may reuire
that an infinite famnily of eigenvalues and asociated eigenfunctions
have bben found via some PDE-equation. But here a pure theoretical problem is
to set up such equations.
\medskip


\noindent
{\bf{Stochastic optimization.}}
Consider a radom motion , which for simplicity is taken as the standard 
additive Browninan motion or
its geometric counterpart with a time-independent volatility.
Now  one can study  optimization problems
where one  seeks to maximize the expected value of a function
which  is called a profit function and is denoted by $\Pi$.
Classic  examples were considered by Bachelier in his article
\emph{La Bourse} from 1900
and was  later been adopted into "mathematics of finance" under the name of "american options".
This leads to  free boundary problems whose analytic solutions are not known.
Here is an example of such an optimization problem:
Let $[0,T]$ be a fixed time interval.
At time $t=0$ the stock market price of a risky asset is known to be $K_0$ and when
$t$ increases the price changes according to a geometric Browwinan motion
with  constant volatility $\sigma$ and some 
deterministic rate of increase $\mu$.
The owner of this risky asset has paid in advance an insurance
$J$ which gives the right to sell the asset at time $T$ for a fixed price
$K_*$ which does not depend upon the actual stock market price $K(T)$, i.e. even
if $K(T)<K_*$ the owner will receive the amount $K_*$  which we for example measure in US-dollar.
If $K(T)>K_*$ the owner is obliged to sell the asset at the current prize.
One may imagine a person who will
need all ackumulated capital at time $T$ or that
the asset in question is no longer open to share-holders at the terminal time $T$.
\medskip

\noindent
During the time interval the stock-market price $K(t)$ changes in a random way
and the owner has the alternative to sell the asset at any time
and receive $K(t)$ which after is kept in a bank with some rate of interest $r$ which at time
$T$ gives the profit
\[ 
e^r{T-t}\cdot K(t)
\]
In this model one may imagine that
$r>\mu$ and it is therefore be tempting to sell
the asset at some time $t<T$ provided that $K(t)$
is relatively high.
The optimisation problem is to find
the critical curve
$t\mapsto K^*(t)$ where the owner 
maximizes expected net profit by selling the asset at the time moment when
$K(t)$ for the first time is equal to $K^*(t)$.
So here the curve $t\mapsto K^*(t)$ constitutes the free boundary. The  analytic solution is not known
for this curve even  when
volatility, $\mu$ and $r$ are constants.
However, numerical solutions are available using Kolmogorov's backward equation,
and  for this specific example many
implemented in computer programs   calculate values of  options in finanical 
affairs,
In more serious applications to real science similar free boundary value problems also occur. But
they are often governed by more involved equations via physical  lawsa and
very  difficult problems arise when
one leaves the "standard parabolic systems" and enter
general non-linear PDE-equations of the parabolic or the hyperbolic type.
For such problems advanced numerical analysis is needed which goes far beyond the rather 
trivial use of Monte Carlo simulations,
though one should admit
that the numerical solutions which are achieved by Monte Carlo methods
are both instrucitve and sometimes also useful  in applications;  though last year's distaster in the 
world-wide financial market system  might have put
severe doubt upon various  models in economics.
But for  sciencific situations which arise in engineering, physics and chemistry
the use of Monte Carlo simulations is
a  valuable  tool.





































 





 
 











 
 


























\end{document}